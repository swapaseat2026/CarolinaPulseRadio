<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Upload Music | 2BANGUZHQ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  min-height:100vh;
  display:grid;
  place-items:center;
  background:#020402;
  color:#fff;
  font-family:system-ui, Arial;
}
.card{
  width:340px;
  padding:24px;
  border-radius:22px;
  background:#0a120a;
}
input,button{
  width:100%;
  padding:12px;
  margin-bottom:12px;
}
button{
  background:#39FF14;
  font-weight:800;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="card">
  <h2>Upload Music</h2>
  <input id="title" placeholder="Song Title">
  <input id="artist" placeholder="Artist">
  <input id="file" type="file" accept="audio/*">
  <button onclick="saveTrack()">Save Track</button>
</div>

<!-- ðŸ”¥ FIREBASE SDKs (ONLY HERE) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey:  "AIzaSyDWACkdw3uQ6HWlECvs9O81ndEcjVbEMnw",
  authDomain: "banguz-hq-ipod.firebaseapp.com",
  projectId:"banguz-hq-ipod",
  storageBucket: "banguz-hq-ipod.appspot.com",
  messagingSenderId:"887274435554",
  appId: "1:887274435554:web:9e7809541400e4e83effbb"
};

firebase.initializeApp(firebaseConfig);
const storage = firebase.storage();
const db = firebase.firestore();

<script>
function saveTrack(){
  const title = document.getElementById("title").value.trim();
  const artist = document.getElementById("artist").value.trim();
  const file = document.getElementById("file").files[0];

  if(!title || !artist || !file){
    alert("Please fill out all fields.");
    return;
  }

  const storageRef = firebase
    .storage()
    .ref("tracks/" + Date.now() + "_" + file.name);

  storageRef.put(file)
    .then(snapshot => snapshot.ref.getDownloadURL())
    .then(downloadURL => {
      return firebase.firestore().collection("tracks").add({
        title: title,
        artist: artist,
        url: downloadURL,
        created: firebase.firestore.FieldValue.serverTimestamp()
      });
    })
    .then(() => {
      // âœ… REDIRECT HAPPENS ONLY AFTER EVERYTHING SAVES
      window.location.href = "player.html";
    })
    .catch(err => {
      console.error(err);
      alert("Upload failed");
    });
}
</script>

</body>
</html>
